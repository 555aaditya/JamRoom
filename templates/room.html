<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JamRoom - {{ room.name }}</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/style.css') }}"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/room.css') }}"
    />
    <link
      rel="icon"
      href="{{ url_for('static', filename='favicon.svg') }}"
      type="image/x-icon"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
  </head>

  <body class="dark-theme">
    <header class="main-header">
      <div class="logo-container">
        <img
          src="{{ url_for('static', filename='Jam-Room.png') }}"
          alt="JamRoom Logo"
          class="logo"
        />
      </div>
      
      <div class="header-right">
          <button id="leave-room-button" class="leave-room-btn">
            Leave Room
          </button>
      </div>
    </header>

    <main class="room-layout">
      <section id="main-player-section" class="player-controls-container">
        
        <div class="room-info">
          <div class="room-key">
            <span class="room-key-label">Room Name</span>
            <span class="room-key-value">{{ room.name }}</span>
          </div>
          <div class="room-key">
            <span class="room-key-label">Room Key</span>
            <span class="room-key-value">{{ room.room_key }}</span>
          </div>
          <div class="room-key">
            <span class="room-key-label">Listeners</span>
            <span class="room-key-value" id="listener-count">{{ room.listeners }}</span>
          </div>
        </div>

        <div class="music-player-area">
          <img
            id="player-artwork"
            src="{{ url_for('static', filename='default-album.png') }}"
            alt="Album Artwork"
            class="player-artwork-large"
          />
          <h3 id="player-current-track"></h3>
          <p id="player-status"></p>

          <div class="progress-container">
            <span id="current-time">0:00</span>
            <div class="progress-bar">
              <div class="progress" id="progress"></div>
            </div>
            <span id="duration">0:00</span>
          </div>

          <div class="volume-container">
            <span>Volume</span>
            <input type="range" id="volume-slider" min="0" max="100" value="70">
            <span id="volume-display">70%</span>
          </div>
          
          <div class="player-controls">
            <button id="prev-btn">⏮️</button>
            <button id="play-pause-btn">▶️</button>
            <button id="next-btn">⏭️</button>
          </div>
        </div>

        <section class="section">
          <h2>Search for Music</h2>
          <div class="search-container">
            <input
              type="text"
              id="music-search-input"
              placeholder="Search for songs or artists..."
              class="room-input"
            />
          </div>
          <div id="music-results-container" class="music-results-container">
            </div>
        </section>

      </section>

      <section id="chat-section" class="chat-container">
        <h2>Chat</h2>
        <div id="messages-container" class="messages-container">
          </div>
        <form id="message-form" class="message-input-form">
          <input
            type="text"
            id="message-input"
            placeholder="Type your message..."
            class="chat-input"
          />
          <button type="submit" class="send-btn">Send</button>
        </form>
      </section>
    </main>
    
    <script src="https://sdk.scdn.co/spotify-player.js"></script>
    
    <script>
        const SPOTIFY_ACCESS_TOKEN = "{{ spotify_access_token if spotify_access_token else '' }}";
        const ROOM_KEY = "{{ room.room_key }}";
        const CURRENT_USER = "{{ session.get('user') }}";
    </script>
    <script src="{{ url_for('static', filename='scripts/room.js') }}"></script>
  </body>
</html>